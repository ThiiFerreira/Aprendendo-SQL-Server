-- inserindo dados em uma tabela dentro do while

IF OBJECT_ID('TABELA DE NUMEROS', 'U') IS NOT NULL
	DROP TABLE [TABELA DE NUMEROS] -- verifica se a tabela ja existe e apaga 

CREATE TABLE [TABELA DE NUMEROS] ([NUMERO] INT, [STATUS] VARCHAR(200))

DECLARE @LIMITE_MINIMO INT, @LIMITE_MAXIMO INT, @CONTADOR_NOTAS INT -- DECLARAÇÃO DE VARIAVEIS

SET @LIMITE_MINIMO = 1 -- ATRIBUINDO VALORES
SET @LIMITE_MAXIMO = 1000

SET NOCOUNT ON -- PARA NÃO APARECER MENSAGEM DE LINHA AFETADA
WHILE @LIMITE_MINIMO <= @LIMITE_MAXIMO
BEGIN
	SELECT @CONTADOR_NOTAS = COUNT(*) FROM [NOTAS FISCAIS] WHERE NUMERO = @LIMITE_MINIMO
	IF @CONTADOR_NOTAS > 0
		INSERT INTO [TABELA DE NUMEROS] ([NUMERO],[STATUS]) VALUES (@LIMITE_MINIMO, 'É nota fiscal')
	ELSE
		INSERT INTO [TABELA DE NUMEROS] ([NUMERO],[STATUS]) VALUES (@LIMITE_MINIMO, 'Não é nota fiscal')
	SET @LIMITE_MINIMO = @LIMITE_MINIMO + 1
END

SELECT * FROM [TABELA DE NUMEROS]